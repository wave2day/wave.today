/* ===== Base / anti-callout ===== */
#qrWrap{
  height:100%;
  margin:0;
  background: transparent;
  -webkit-touch-callout:none;
  -webkit-user-select:none;
  user-select:none;
}
#wtOrb, #wtOrb * , #wtOverlay, #wtCard, #wtCard *{
  -webkit-touch-callout:none;
  -webkit-user-select:none;
  user-select:none;
}
#wtOrb img, .frontImg, #wtCard img{ pointer-events:none; }
#wtOrb.wt-dragging{ cursor:grabbing; opacity:1 !important; }
#wtOrb:not(.wt-dragging){ cursor:grab; }

/* ===== Orb (sticker) ===== */
#wtOrb{
  position:fixed;
  top:calc(10px + 96px + env(safe-area-inset-top));
  left:10px;
  width:86px;
  height:86px;
  z-index:999999;
  -webkit-tap-highlight-color:transparent;
  filter:drop-shadow(0 10px 22px rgba(0,0,0,.45));
  touch-action:pan-y;
}
@media (min-width:900px){
  #wtOrb{ width:110px; height:110px; top:16px; left:16px; }
}
#wtOrb img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
  opacity:.95;
  -webkit-user-drag:none;
}

/* ===== Overlay flip card (center) ===== */
#wtOverlay{
  position:fixed;
  inset:0;
  display:none;
  place-items:center;
  z-index:1000000;
  pointer-events:none;
  opacity:0;
  transition:opacity 180ms ease;
}
#wtOverlay.is-open{
  display:grid;
  opacity:1;
  pointer-events:auto;
}
#wtOverlay .backdrop{ position:absolute; inset:0; background:transparent; }

#wtCard{
  position:fixed;
  left:50%;
  top:50%;
  width:360px;
  height:360px;
  aspect-ratio:1;
  transform:translate(-50%, -50%) translateZ(0);
  perspective:1100px;
  pointer-events:auto;
  z-index:1000001;
}

/* MOBIL: žádné scale — jen reálné menší pixely (stabilní rohy) */
@media (max-width:700px){
  #wtCard{
    width:320px;
    height:320px;
    transform:translate(-50%, -50%) translateZ(0);
    transform-origin:center;
  }
}

#wtInner{
  position:absolute;
  inset:0;
  transform-style:preserve-3d;
  transition:transform 520ms cubic-bezier(.2,.8,.2,1);
}
#wtOverlay.is-open #wtInner{ transform:rotateY(180deg); }

.wtFace{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  backface-visibility:hidden;
  -webkit-backface-visibility:hidden;
}
.wtFront{ border-radius:22px; }
.wtFront .frontImg{
  width:56%;
  height:56%;
  border-radius:20px;
  display:block;
  filter:drop-shadow(0 18px 34px rgba(0,0,0,.42));
  opacity:.95;
}
.wtBack{ transform:rotateY(180deg); }

/* ===== Glass label (fits into card) ===== */
:root{
  --sqOuter: 360px;
  --innerRatio: .78;
  --sqR: 34px;
  --coreRk: 1.55;

  --glassRing: 13px;
  --pressY: 3px;
  --pressTimeIn: 110ms;
  --pressTimeOut: 190ms;
}

/* MOBIL: sklo fyzicky menší (zase bez scale) */
@media (max-width:700px){
  :root{ --sqOuter: 320px; }
}

.glassSquare{
  --gap: calc(var(--sqOuter) * (1 - var(--innerRatio)) / 2);
  --coreR: calc(var(--sqR) - (var(--gap) * var(--coreRk)));

  width: var(--sqOuter);
  height: var(--sqOuter);
  border-radius: var(--sqR);
  position:relative;
  display:grid;
  place-items:center;
  isolation:isolate;

  /* KLÍČ: stejné rohy pro všechny vrstvy */
  overflow:hidden;

  /* žádný backdrop-filter (často rozbije ořez a rohy na mobilech) */
  background: rgba(255,255,255,.08);

  /* “Sklo” jako čisté vnitřní vrstvy, bez blurů a bez masek */
  box-shadow:
    0 26px 54px rgba(0,0,0,.20),
    inset 0 0 0 1px rgba(255,255,255,.10),
    inset 0 18px 26px rgba(0,0,0,.22),
    inset 0 -22px 30px rgba(255,255,255,.18);

  transition: filter var(--pressTimeOut) ease;
}

.glassSquare::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius: inherit;
  pointer-events:none;
  z-index:1;

  /* jemný skleněný “noise” světla – symetricky */
  background:
    radial-gradient(120% 140% at 50% 62%, rgba(255,255,255,.10), transparent 62%),
    radial-gradient(120% 160% at 50% 92%, rgba(255,255,255,.10), transparent 58%),
    radial-gradient(120% 140% at 28% 20%, rgba(255,255,255,.14), transparent 55%),
    radial-gradient(140% 160% at 70% 74%, rgba(255,255,255,.08), transparent 60%);
  opacity:.95;
}

/* HRANA: inset box-shadow = konzistentní tloušťka i rohy */
.glassSquare::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius: inherit;
  pointer-events:none;
  z-index:2;

  background:
    radial-gradient(140% 140% at 50% 50%,
      rgba(170,190,255,.06) 0%,
      rgba(170,190,255,.02) 42%,
      transparent 70%);

  box-shadow:
    inset 0 0 0 var(--glassRing) rgba(255,255,255,.14),
    inset 0 0 0 calc(var(--glassRing) + 1px) rgba(0,0,0,.18);
  opacity:.95;
}

/* ===== Press glow (ponecháno) ===== */
.qr_pressGlow{
  position:absolute;
  inset:-28px;
  border-radius: calc(var(--sqR) + 14px);
  pointer-events:none;
  opacity:0;
  filter: blur(12px);
  transform: scale(.995);
  transition: opacity var(--pressTimeOut) ease, transform var(--pressTimeOut) ease;
  z-index:0;

  background:
    radial-gradient(86% 86% at 70% 74%,
      rgba(255,255,255,.18) 0%,
      rgba(255,255,255,.10) 30%,
      transparent 65%),
    radial-gradient(120% 100% at 50% 120%,
      rgba(255,255,255,.16) 0%,
      transparent 55%);
}

/* ===== White plastic core (QR base) ===== */
.qr_coreSquare{
  width:  calc(var(--sqOuter) - (2 * var(--gap)));
  height: calc(var(--sqOuter) - (2 * var(--gap)));
  border-radius: max(14px, var(--coreR));

  position:relative;
  z-index:3;
  border:0;
  padding:0;
  cursor:pointer;

  outline:none !important;
  -webkit-tap-highlight-color: transparent;
  user-select:none;

  background: linear-gradient(180deg, #fff, #f2f2f7 55%, #dadbe4);

  box-shadow:
    0 18px 26px rgba(0,0,0,.18),
    inset 0 16px 22px rgba(0,0,0,.14),
    inset 0 -14px 20px rgba(255,255,255,.16),
    inset 0 0 0 1px rgba(0,0,0,.14);

  transform: translateY(0);
  transition:
    transform var(--pressTimeOut) cubic-bezier(.2,.8,.2,1),
    box-shadow var(--pressTimeOut) ease,
    filter var(--pressTimeOut) ease;
}
.qr_coreSquare::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius: inherit;
  pointer-events:none;
  /* tenká vnitřní “hranka” bez masek */
  box-shadow:
    inset 0 0 0 6px rgba(255,255,255,.10),
    inset 0 0 0 7px rgba(0,0,0,.14);
  opacity:.95;
}

.qrWrap{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  pointer-events:none;
  z-index:10;
}
.qrWrap .qrSvg{
  width:88%;
  height:88%;
  display:block;
  shape-rendering: crispEdges;
}

.qr_coreSquare:hover{
  transform: translateY(-1px);
  box-shadow:
    0 22px 30px rgba(0,0,0,.20),
    inset 0 14px 20px rgba(0,0,0,.12),
    inset 0 -14px 20px rgba(255,255,255,.16),
    inset 0 0 0 1px rgba(0,0,0,.14);
}

.glassSquare:has(.qr_coreSquare:active){
  filter: brightness(.985);
  transition: filter var(--pressTimeIn) ease;
}
.glassSquare:has(.qr_coreSquare:active) .qr_pressGlow{
  opacity:1;
  transform: scale(1.01);
  transition: opacity var(--pressTimeIn) ease, transform var(--pressTimeIn) ease;
}

.qr_coreSquare:active{
  transform: translateY(var(--pressY));
  transition:
    transform var(--pressTimeIn) cubic-bezier(.2,.8,.2,1),
    box-shadow var(--pressTimeIn) ease,
    filter var(--pressTimeIn) ease;
  box-shadow:
    0 10px 18px rgba(0,0,0,.16),
    inset 0 20px 26px rgba(0,0,0,.18),
    inset 0 -10px 16px rgba(255,255,255,.12),
    inset 0 0 0 1px rgba(0,0,0,.14);
  filter: brightness(.995) saturate(.98);
}

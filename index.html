<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>wave.today</title>

<!-- ===== SHARE CSS (p≈Øvodn√≠) ===== -->
<style>

  :root{
    --pageBg:transparent;

    /* ===== edge-to-edge sheet geometry ===== */
    --sheetR: 32px;                 /* horn√≠ radius plochy */
    --sinkY: 0px;                  /* kolik je plocha pod displejem (zmiz√≠ spodn√≠ hrana) */
    --platePad: 18px;               /* üî• jednotn√Ω odsazen√≠ (L/R/T) */

    --rimTopA: 0.26;     /* s√≠la horn√≠ho rim svƒõtla */
    --sheenA: 0.11;      /* jemn√Ω lesk p≈ôes plochu */

    /* ===== p≈Øvodn√≠ sklo promƒõnn√© ===== */
    --glassClearA: rgba(255,255,255,.14);
    --glassClearB: rgba(255,255,255,.08);
    --glassMilkA:  rgba(255,255,255,.10);
    --glassMilkB:  rgba(255,255,255,.12);

    --glassRingThickness: 13px;
    --glassRimBlur: 1.05px;

    --topRimFade: 30%;

    --botRim1: rgba(255,255,255,.74);
    --botRim2: rgba(255,255,255,.30);

    --bleedA: .085;
    --bleedB: .040;

    --pressTimeIn: 110ms;
    --pressTimeOut: 190ms;

    --rimTint: 170, 190, 255;
    --bleedX: 78%;
    --bleedY: 86%;
  }

  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    background: var(--pageBg);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:#fff;
    overscroll-behavior-y:contain;
  }

  /* =========================
     CONTENT PLACEHOLDER
  ========================= */
  .main{
    min-height:200vh;
    background: transparent;
  }

  /* =========================
     BACKDROP
  ========================= */
  #wtSheetBackdrop{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.28);
    opacity:0;
    pointer-events:none;
    transition:opacity .18s ease;
    z-index:20000;
  }
  #wtSheetBackdrop.show{ opacity:1; pointer-events:auto; }

  /* =========================
     ACTION SHEET (chov√°n√≠ stejn√©)
  ========================= */
  #wtActionSheet{
    position:fixed;
    left:0;
    right:0;
    bottom:0;

    transform:translateY(120%);
    transition:transform .3s cubic-bezier(.2,.9,.2,1);

    z-index:21000;

    padding:0;          /* edge-to-edge */
    overflow: visible;    /* flat bottom: no cut */
    pointer-events:none;
  }
  #wtActionSheet.show{ transform:translateY(0); pointer-events:auto; }

  /* v3.1 ‚Äî v√Ωraznƒõj≈°√≠ ‚Äûpop‚Äú p≈ôi otev≈ôen√≠ panelu */
  .glassPlate{
    transition: transform .22s cubic-bezier(.2,.85,.2,1);
  }
  #wtActionSheet.show .glassPlate{
    transform: translateY(0);
  }


  /* =========================================================
     GLASS PLATE ‚Äî edge-to-edge, tight top spacing
     ========================================================= */
  .glassPlate{
    position:relative;
    width:100vw;
    border-radius: var(--sheetR) var(--sheetR) 0 0;
    transform: translateY(0);
    isolation:isolate;

    padding:
      var(--platePad)
      calc(var(--platePad) + env(safe-area-inset-right))
      calc(var(--platePad) + env(safe-area-inset-bottom))
      calc(var(--platePad) + env(safe-area-inset-left));

    background:
      radial-gradient(120% 140% at 50% 62%, var(--glassMilkA), transparent 62%),
      radial-gradient(120% 160% at 50% 92%, var(--glassMilkB), transparent 58%),
      radial-gradient(120% 140% at 28% 20%, var(--glassClearA), transparent 55%),
      radial-gradient(140% 160% at 70% 74%, var(--glassClearB), transparent 60%),
      rgba(255,255,255,.08);

    box-shadow:
      inset 0 18px 26px rgba(0,0,0,.24),
      inset 0 -22px 30px rgba(255,255,255,.22),
      0 26px 54px rgba(0,0,0,.20);

    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    transition: filter var(--pressTimeOut) ease;
  }

  .glassPlate::before{
    content:"";
    position:absolute;
    inset: 12px;
    border-radius: calc(var(--sheetR) - 6px) calc(var(--sheetR) - 6px) 0 0;
    pointer-events:none;
    z-index:1;

    background:
      /* horn√≠ rim svƒõtlo ‚Äì symetrick√© */
    radial-gradient(120% 70% at 50% 0%,
      rgba(255,255,255,var(--rimTopA)) 0%,
      rgba(255,255,255,0.10) 22%,
      rgba(255,255,255,0.00) 55%),

    /* jemn√Ω ‚Äûsheen‚Äú ‚Äì symetrick√Ω, bez posunu */
    linear-gradient(180deg,
      rgba(255,255,255,var(--sheenA)) 0%,
      rgba(255,255,255,0.00) 35%,
      rgba(255,255,255,0.00) 100%),

    radial-gradient(70% 90% at 16% 18%,
        rgba(255,255,255,.42) 0%,
        rgba(255,255,255,.18) 35%,
        transparent 72%),
      radial-gradient(70% 90% at 84% 18%,
        rgba(255,255,255,.42) 0%,
        rgba(255,255,255,.18) 35%,
        transparent 72%),
      radial-gradient(44% 60% at 26% 30%,
        rgba(255,255,255,.18) 0%,
        transparent 72%),
      radial-gradient(44% 60% at 74% 30%,
        rgba(255,255,255,.18) 0%,
        transparent 72%);

    filter: blur(1.35px);
    opacity:.95;
  }

  .glassPlate::after{
    transform: translateZ(0); /* GPU safety for blur stability */
    content:"";
    position:absolute;
    inset:-1px;
    border-radius: var(--sheetR) var(--sheetR) 0 0;
    pointer-events:none;
    z-index:2;

    background:
      radial-gradient(72% 120% at var(--bleedX) var(--bleedY),
        rgba(var(--rimTint), var(--bleedA)) 0%,
        rgba(var(--rimTint), var(--bleedB)) 28%,
        transparent 68%),

      conic-gradient(from 210deg,
        transparent 0 18%,
        rgba(var(--rimTint), .09) 22%,
        transparent 36%,
        rgba(var(--rimTint), .045) 46%,
        transparent 62%,
        rgba(var(--rimTint), .032) 70%,
        transparent 100%),

      linear-gradient(90deg,
        rgba(var(--rimTint), .085) 0%,
        rgba(var(--rimTint), .055) 8%,
        transparent 22%,
        transparent 78%,
        rgba(var(--rimTint), .055) 92%,
        rgba(var(--rimTint), .085) 100%),

      /* bottom rim removed (flat bottom) */


      radial-gradient(170% 120% at 50% -38%,
        rgba(0,0,0,.30) 0%,
        rgba(0,0,0,.12) 14%,
        transparent var(--topRimFade));

    -webkit-mask:
      linear-gradient(#000 0 0) content-box,
      linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;

    padding: 13px;
    filter: blur(1.05px);
    opacity:.95;
  }

  .pressGlow{
    position:absolute;
    inset:-28px;
    border-radius: calc(var(--sheetR) + 14px);
    pointer-events:none;
    opacity:0;
    filter: blur(12px);
    transform: scale(.995);
    transition: opacity var(--pressTimeOut) ease, transform var(--pressTimeOut) ease;
    z-index:0;

    background:
      radial-gradient(86% 86% at 70% 74%,
        rgba(255,255,255,.18) 0%,
        rgba(255,255,255,.10) 30%,
        transparent 65%),
      radial-gradient(120% 100% at 50% 120%,
        rgba(255,255,255,.16) 0%,
        transparent 55%);
  }

  /* =========================================================
     WHITE CORE ‚Äî top gap = stejn√© jako L/R padding (platePad)
     ========================================================= */
  .coreSquare{
    position:relative;
    z-index:3;

    width: 100%;           /* üî• sed√≠ p≈ôesnƒõ do plate paddingu */
    margin: 0;             /* üî• ≈æ√°dn√° extra mezera nav√≠c */

    border-radius: calc(var(--sheetR) - 6px);
    clip-path: inset(0 round calc(var(--sheetR) - 6px));
    backface-visibility: hidden;
    border:0;
    padding: 0;

    --c1:#ffffff;
    --c2:#f1f1f6;
    --c3:#d9d9e2;

    background:
      radial-gradient(120% 140% at 28% 18%, rgba(255,255,255,.20), transparent 55%),
      linear-gradient(180deg, var(--c1), var(--c2) 55%, var(--c3));

    box-shadow:
      0 18px 26px rgba(0,0,0,.18),
      inset 0 16px 22px rgba(0,0,0,.16),
      inset 0 -14px 20px rgba(255,255,255,.18),
      inset 0 0 0 1px rgba(0,0,0,.16);

    overflow:hidden;
  }

  .coreSquare::before{
    content:"";
    position:absolute;
    inset:0;
    border-radius: inherit;
    pointer-events:none;
    background:
      radial-gradient(120% 140% at 50% 50%,
        transparent 60%,
        rgba(0,0,0,.32) 100%);
    mix-blend-mode: soft-light;
    opacity:.96;
  }

  .coreSquare::after{
    content:"";
    position:absolute;
    inset:-1px;
    border-radius: inherit;
    pointer-events:none;

    background:
      radial-gradient(140% 120% at 50% 120%,
        rgba(255,255,255,.70) 0%,
        rgba(255,255,255,.30) 26%,
        transparent 56%),
      radial-gradient(170% 120% at 50% -38%,
        rgba(0,0,0,.34) 0%,
        rgba(0,0,0,.14) 16%,
        transparent 34%);

    -webkit-mask:
      linear-gradient(#000 0 0) content-box,
      linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;

    padding: 6px;
    filter: blur(.78px);
    opacity:.95;
  }

  /* 3 ≈ô√°dky uvnit≈ô core */
  .shareCore{ display:flex; flex-direction:column; }
  .shareRow{
    appearance:none;
    border:0;
    background:transparent;

    font-family: inherit;
    font-size:18px;
    font-weight:850;
    letter-spacing:.2px;
    text-align:center;

    color: rgba(18,18,22,.88);
    cursor:pointer;

    padding: 18px 16px;
  }
  .shareRow + .shareRow{ border-top: 1px solid rgba(0,0,0,.12); }
  .shareRow:active{ transform: translateY(1px); opacity:.9; }

  /* press glow trigger */
  .glassPlate:has(.shareRow:active){
    filter: brightness(.985);
    transition: filter var(--pressTimeIn) ease;
  }
  .glassPlate:has(.shareRow:active) .pressGlow{
    opacity:1;
    transform: scale(1.01);
    transition: opacity var(--pressTimeIn) ease, transform var(--pressTimeIn) ease;
  }

/* ===== FIX: disable browser blue tap highlight / focus paint on rows ===== */
.shareRow{
  -webkit-tap-highlight-color: transparent;
  tap-highlight-color: transparent;
}
.shareRow:focus,
.shareRow:focus-visible{
  outline: none !important;
  box-shadow: none !important;
}
.shareRow::-moz-focus-inner{ border:0; }



/* =========================================================
   SHARE ORB ‚Äî glass button (based on sharebtn.html)
   Replaces the old WTStickerFlip #shareOrb (no duplication)
   ========================================================= */
/* outer glass */
/* press glow (scoped to orb to avoid collision with sheet .pressGlow) */
/* inner clickable core */
#shareOrb .wtShareIcon{ width:22px; height:22px; }
#shareOrb .wtShareIcon circle{ fill:#111; }
#shareOrb .wtShareIcon path{
  stroke:#111; stroke-width:2; fill:none;
  stroke-linecap:round; stroke-linejoin:round;
}

/* harden fixed positioning + kill tap highlight / focus glow */
#shareOrb{ position:fixed !important; }
#shareOrb, #shareOrb *{
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
}
#shareOrb button{ outline:none !important; }
#shareOrb button::-moz-focus-inner{ border:0; }

/* === share orb: exact engine from sharebtn.html (scoped) === */
#shareOrb{
  --outer: 86px;
  --innerRatio: .65;

  --glassClearA: rgba(255,255,255,.14);
  --glassClearB: rgba(255,255,255,.08);
  --glassMilkA:  rgba(255,255,255,.10);
  --glassMilkB:  rgba(255,255,255,.12);

  --glassRingThickness: calc(var(--outer) * 0.068421); /* 13/190 */
  --glassRimBlur: 1.05px;

  /* ratio locks (from reference 190px) */
  --smearInset: calc(var(--outer) * 0.052632); /* 10/190 */

  --topRim1: rgba(0,0,0,.28);
  --topRim2: rgba(0,0,0,.12);
  --topRimFade: 30%;

  --botRim1: rgba(255,255,255,.74);
  --botRim2: rgba(255,255,255,.30);

  --bleedA: .14;
  --bleedB: .07;

  --pressY: 3px;
  --pressTimeIn: 110ms;
  --pressTimeOut: 190ms;

  position: fixed;
  top: calc(env(safe-area-inset-top) + 16px);
  left: calc(env(safe-area-inset-left) + 16px);
  z-index: 30000;
}
#shareOrb, #shareOrb *{
  -webkit-tap-highlight-color: transparent;
}
#shareOrb .shareIcon{ width: clamp(22px, calc(var(--outer) * 0.210526), 40px); height: clamp(22px, calc(var(--outer) * 0.210526), 40px); } /* ref 40/190 */ /* 40/190 */

/* jen ƒçist√© pl√°tno */
  /* =========================================================
     SPOLEƒåN√ù ENGINE ‚Äî sklo + core
     ========================================================= */
  .glassBase {
--w: var(--outer);
    --h: var(--outer);
    --r: 50%;
    --smearInset: 10px;

    --rimTint: 120, 155, 255;
    --bleedX: 76%;
    --bleedY: 84%;

    width: var(--w);
    height: var(--h);
    border-radius: var(--r);
    position: relative;
    display:grid;
    place-items:center;
    isolation:isolate;

    background:
      radial-gradient(120% 120% at 50% 60%, var(--glassMilkA), transparent 62%), radial-gradient(120% 120% at 50% 92%, var(--glassMilkB), transparent 58%), radial-gradient(120% 120% at 35% 25%, var(--glassClearA), transparent 55%), radial-gradient(140% 140% at 65% 70%, var(--glassClearB), transparent 60%), rgba(255, 255, 255, .08);

    box-shadow:
      inset 0 18px 26px rgba(0, 0, 0, .24), inset 0 -22px 30px rgba(255, 255, 255, .22), 0 22px 44px rgba(0, 0, 0, .18);

    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);

    transition: filter var(--pressTimeOut) ease;
  }

  .glassBase::before {
content:"";
    position:absolute;
    inset: var(--smearInset);
    border-radius: var(--r);
    pointer-events:none;
    z-index:1;

    background:
      radial-gradient(75% 60% at 18% 22%, rgba(255, 255, 255, .42) 0%, rgba(255, 255, 255, .18) 35%, transparent 72%), radial-gradient(55% 45% at 28% 32%, rgba(255, 255, 255, .18) 0%, transparent 72%);

    filter: blur(1.35px);
    opacity:.95;
  }

  .glassBase::after {
content:"";
    position:absolute;
    inset:-1px;
    border-radius: var(--r);
    pointer-events:none;
    z-index:2;

    background:
      radial-gradient(72% 60% at var(--bleedX) var(--bleedY), rgba(var(--rimTint), var(--bleedA)) 0%, rgba(var(--rimTint), var(--bleedB)) 28%, transparent 68%), conic-gradient(from 210deg, transparent 0 18%, rgba(var(--rimTint), .12) 22%, transparent 36%, rgba(var(--rimTint), .06) 46%, transparent 62%, rgba(var(--rimTint), .045) 70%, transparent 100%), radial-gradient(140% 120% at 50% 120%, var(--botRim1) 0%, var(--botRim2) 22%, transparent 52%), radial-gradient(170% 120% at 50% -38%, var(--topRim1) 0%, var(--topRim2) 14%, transparent var(--topRimFade));

    -webkit-mask:
      linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;

    padding: var(--glassRingThickness);
    filter: blur(var(--glassRimBlur));
    opacity:.95;
  }

  /* press glow mimo sklo */
  .glassBase .pressGlow {
position:absolute;
    inset:-22px;
    border-radius: var(--r);
    pointer-events:none;
    opacity:0;
    filter: blur(10px);
    transition: opacity var(--pressTimeOut) ease, transform var(--pressTimeOut) ease;
    transform: scale(0.995);
    z-index:0;
    background:
      radial-gradient(80% 80% at 70% 70%, rgba(var(--rimTint), .18) 0%, rgba(var(--rimTint), .10) 26%, transparent 62%), radial-gradient(100% 90% at 50% 110%, rgba(255, 255, 255, .20) 0%, transparent 55%);
  }

  

  /* ratio fix for small orbs: keep the same look as reference */
  #shareOrb .pressGlow{
    inset: calc(var(--outer) * -0.115789); /* -22/190 */
    filter: blur(calc(var(--outer) * 0.052632)); /* 10/190 */
  }
.coreBtn {
--cw: calc(var(--outer) * var(--innerRatio));
    --ch: calc(var(--outer) * var(--innerRatio));
    --cr: 50%;

    width: var(--cw);
    height: var(--ch);
    border-radius: var(--cr);

    position:relative;
    z-index:3;
    border:0;
    padding:0;
    cursor:pointer;

    /* zab√≠t modr√Ω focus overlay */
    outline: none !important;
    -webkit-tap-highlight-color: transparent;
    user-select:none;

    background:
      radial-gradient(120% 120% at 35% 25%, rgba(255, 255, 255, .16), transparent 55%), linear-gradient(180deg, var(--c1), var(--c2) 55%, var(--c3));

    box-shadow:
      0 18px 26px rgba(0, 0, 0, .18), inset 0 16px 22px rgba(0, 0, 0, .13), inset 0 -14px 20px rgba(255, 255, 255, .14);

    transform: translateY(0);
    transition:
      transform var(--pressTimeOut) cubic-bezier(.2, .8, .2, 1), box-shadow var(--pressTimeOut) ease, filter var(--pressTimeOut) ease;

    display:grid;
    place-items:center; /* NOV√â: jen aby se SVG vycentrovalo */
  }

  .coreBtn:focus, #shareOrb .coreBtn:focus-visible { outline:none !important; }
#shareOrb .coreBtn::before {
content:"";
    position:absolute;
    inset:0;
    border-radius: inherit;
    pointer-events:none;
    background:
      radial-gradient(120% 120% at 50% 50%, transparent 62%, rgba(0, 0, 0, .26) 100%);
    mix-blend-mode: soft-light;
    opacity:.95;
  }

  .coreBtn::after {
content:"";
    position:absolute;
    inset:-1px;
    border-radius: inherit;
    pointer-events:none;

    background:
      radial-gradient(140% 120% at 50% 120%, rgba(255, 255, 255, .52) 0%, rgba(255, 255, 255, .20) 24%, transparent 52%), radial-gradient(170% 120% at 50% -38%, rgba(0, 0, 0, .30) 0%, rgba(0, 0, 0, .12) 14%, transparent 30%);

    -webkit-mask:
      linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;

    padding: 6px;
    filter: blur(.78px);
    opacity:.95;
    mix-blend-mode: screen;
  }

  
  #shareOrb .coreBtn::after{ padding: calc(var(--outer) * 0.031579); /* 6/190 */ }
.coreBtn:hover {
transform: translateY(-1px);
    box-shadow:
      0 22px 30px rgba(0, 0, 0, .20), inset 0 14px 20px rgba(0, 0, 0, .12), inset 0 -14px 20px rgba(255, 255, 255, .14);
  }

  .glassBase:has(.coreBtn:active) {
filter: brightness(.985);
    transition: filter var(--pressTimeIn) ease;
  }
  .glassBase:has(.coreBtn:active) .pressGlow {
opacity:1;
    transform: scale(1.01);
    transition: opacity var(--pressTimeIn) ease, transform var(--pressTimeIn) ease;
  }
  .coreBtn:active {
transform: translateY(var(--pressY));
    transition:
      transform var(--pressTimeIn) cubic-bezier(.2, .8, .2, 1), box-shadow var(--pressTimeIn) ease, filter var(--pressTimeIn) ease;

    box-shadow:
      0 10px 18px rgba(0, 0, 0, .16), inset 0 20px 26px rgba(0, 0, 0, .18), inset 0 -10px 16px rgba(255, 255, 255, .10);
    filter: brightness(.99) saturate(.98);
  }

  /* kruh */
  .circle {
--w: var(--outer);
    --h: var(--outer);
    --r: 50%;
  }
  .circle .coreBtn {
--cw: calc(var(--outer) * var(--innerRatio));
    --ch: calc(var(--outer) * var(--innerRatio));
    --cr: 50%;
  }

  /* modr√° varianta (p≈Øvodn√≠) */
  .v-blue {
--c1:#6f7ed0; --c2:#5462bb; --c3:#4a57ae;
    --rimTint: 120, 155, 255;
    --bleedX:50%; --bleedY: 86%;
  }

  /* NOV√â: b√≠l√° varianta */
  .v-white {
--c1:#ffffff; --c2:#f1f1f6; --c3:#d9d9e2;
    --rimTint: 210, 210, 210;
    --bleedX:50%; --bleedY: 86%;
  }

  /* NOV√â: ikona */
  .shareIcon { width:40px; height:40px; }
#shareOrb .shareIcon circle { fill:#111; }
#shareOrb .shareIcon path {
    stroke:#111; stroke-width:2; fill:none;
    stroke-linecap:round; stroke-linejoin:round;
  }

</style>

<!-- ===== QR CSS (minim√°ln√≠ √∫pravy: jen odpojen√≠ od html/body + p≈ôejmenov√°n√≠ 2 t≈ô√≠d) ===== -->
<style>

/* ===== Base / anti-callout ===== */
#qrWrap{
  height:100%;
  margin:0;
  background: transparent;
  -webkit-touch-callout:none;
  -webkit-user-select:none;
  user-select:none;
}
#wtOrb, #wtOrb * , #wtOverlay, #wtCard, #wtCard *{
  -webkit-touch-callout:none;
  -webkit-user-select:none;
  user-select:none;
}
#wtOrb img, .frontImg, #wtCard img{ pointer-events:none; }
#wtOrb.wt-dragging{ cursor:grabbing; opacity:1 !important; }
#wtOrb:not(.wt-dragging){ cursor:grab; }

/* ===== Orb (sticker) ===== */
#wtOrb{
  position:fixed;
  top:calc(10px + 96px + env(safe-area-inset-top));
  left:10px;
  width:86px;
  height:86px;
  z-index:999999;
  -webkit-tap-highlight-color:transparent;
  filter:drop-shadow(0 10px 22px rgba(0,0,0,.45));
  touch-action:pan-y;
}
@media (min-width:900px){
  #wtOrb{ width:110px; height:110px; top:16px; left:16px; }
}
#wtOrb img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
  opacity:.95;
  -webkit-user-drag:none;
}

/* ===== Overlay flip card (center) ===== */
#wtOverlay{
  position:fixed;
  inset:0;
  display:none;
  place-items:center;
  z-index:1000000;
  pointer-events:none;
  opacity:0;
  transition:opacity 180ms ease;
}
#wtOverlay.is-open{
  display:grid;
  opacity:1;
  pointer-events:auto;
}
#wtOverlay .backdrop{ position:absolute; inset:0; background:transparent; }

#wtCard{
  position:relative;
  width:min(78vw, 280px);
  aspect-ratio:1;
  perspective:1100px;
  pointer-events:auto;
  transform:translateZ(0);
}

#wtInner{
  position:absolute;
  inset:0;
  transform-style:preserve-3d;
  transition:transform 520ms cubic-bezier(.2,.8,.2,1);
}
#wtOverlay.is-open #wtInner{ transform:rotateY(180deg); }

.wtFace{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  backface-visibility:hidden;
  -webkit-backface-visibility:hidden;
}
.wtFront{ border-radius:22px; }
.wtFront .frontImg{
  width:56%;
  height:56%;
  border-radius:20px;
  display:block;
  filter:drop-shadow(0 18px 34px rgba(0,0,0,.42));
  opacity:.95;
}
.wtBack{ transform:rotateY(180deg); }

/* ===== Glass label (fits into card) ===== */
:root{
  --sqOuter: 360px;
  --innerRatio: .78;
  --sqR: 34px;
  --coreRk: 1.55;

  --glassClearA: rgba(255,255,255,.14);
  --glassClearB: rgba(255,255,255,.08);
  --glassMilkA:  rgba(255,255,255,.10);
  --glassMilkB:  rgba(255,255,255,.12);

  --glassRingThickness: 13px;
  --glassRimBlur: 1.05px;

  --topRimFade: 30%;
  --botRim1: rgba(255,255,255,.74);
  --botRim2: rgba(255,255,255,.30);

  --bleedA: .085;
  --bleedB: .040;

  --pressY: 3px;
  --pressTimeIn: 110ms;
  --pressTimeOut: 190ms;
}
.glassSquare{
  --rimTint: 170, 190, 255;
  --bleedX: 78%;
  --bleedY: 86%;

  --gap: calc(var(--sqOuter) * (1 - var(--innerRatio)) / 2);
  --coreR: calc(var(--sqR) - (var(--gap) * var(--coreRk)));
  width:min(84%, 260px);
  height:min(84%, 260px);
  border-radius:22px;
  position:relative;
  display:grid;
  place-items:center;
  isolation:isolate;

  background:
    radial-gradient(120% 140% at 50% 62%, var(--glassMilkA), transparent 62%),
    radial-gradient(120% 160% at 50% 92%, var(--glassMilkB), transparent 58%),
    radial-gradient(120% 140% at 28% 20%, var(--glassClearA), transparent 55%),
    radial-gradient(140% 160% at 70% 74%, var(--glassClearB), transparent 60%),
    rgba(255,255,255,.08);

  box-shadow:
    inset 0 18px 26px rgba(0,0,0,.24),
    inset 0 -22px 30px rgba(255,255,255,.22),
    0 26px 54px rgba(0,0,0,.20);

  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);

  transition: filter var(--pressTimeOut) ease;
}
.glassSquare::before{
  content:"";
  position:absolute;
  inset:12px;
  border-radius:16px;
  pointer-events:none;
  z-index:1;

  background:
    radial-gradient(70% 90% at 16% 18%,
      rgba(255,255,255,.42) 0%,
      rgba(255,255,255,.18) 35%,
      transparent 72%),
    radial-gradient(44% 60% at 26% 30%,
      rgba(255,255,255,.18) 0%,
      transparent 72%);

  filter:blur(1.35px);
  opacity:.95;
}
.glassSquare::after{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius:22px;
  pointer-events:none;
  z-index:2;

  background:
    radial-gradient(72% 120% at var(--bleedX) var(--bleedY),
      rgba(var(--rimTint), var(--bleedA)) 0%,
      rgba(var(--rimTint), var(--bleedB)) 28%,
      transparent 68%),

    conic-gradient(from 210deg,
      transparent 0 18%,
      rgba(var(--rimTint), .09) 22%,
      transparent 36%,
      rgba(var(--rimTint), .045) 46%,
      transparent 62%,
      rgba(var(--rimTint), .032) 70%,
      transparent 100%),

    radial-gradient(140% 120% at 50% 120%,
      var(--botRim1) 0%,
      var(--botRim2) 22%,
      transparent 52%),

    radial-gradient(170% 120% at 50% -38%,
      rgba(0,0,0,.30) 0%,
      rgba(0,0,0,.12) 14%,
      transparent var(--topRimFade));

  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;

  padding:var(--glassRingThickness);
  filter:blur(var(--glassRimBlur));
  opacity:.95;
}

.qr_pressGlow{
  position:absolute;
  inset:-28px;
  border-radius:36px;
  pointer-events:none;
  opacity:0;
  filter:blur(12px);
  transform:scale(.995);
  transition:opacity var(--pressTimeOut) ease, transform var(--pressTimeOut) ease;
  z-index:0;

  background:
    radial-gradient(86% 86% at 70% 74%,
      rgba(255,255,255,.18) 0%,
      rgba(255,255,255,.10) 30%,
      transparent 65%),
    radial-gradient(120% 100% at 50% 120%,
      rgba(255,255,255,.16) 0%,
      transparent 55%);
}

.qr_coreSquare{
  width:calc(100% - (2 * (100% * (1 - var(--innerRatio)) / 2)));
  height:calc(100% - (2 * (100% * (1 - var(--innerRatio)) / 2)));
  border-radius:18px;

  position:relative;
  z-index:3;
  border:0;
  padding:0;
  cursor:pointer;

  outline:none !important;
  -webkit-tap-highlight-color:transparent;

  --c1:#fff;
  --c2:#f1f1f6;
  --c3:#d9d9e2;

  background:
    radial-gradient(120% 140% at 28% 18%, rgba(255,255,255,.20), transparent 55%),
    linear-gradient(180deg, var(--c1), var(--c2) 55%, var(--c3));

  box-shadow:
    0 18px 26px rgba(0,0,0,.18),
    inset 0 16px 22px rgba(0,0,0,.16),
    inset 0 -14px 20px rgba(255,255,255,.18),
    inset 0 0 0 1px rgba(0,0,0,.16);

  transform:translateY(0);
  transition:
    transform var(--pressTimeOut) cubic-bezier(.2,.8,.2,1),
    box-shadow var(--pressTimeOut) ease,
    filter var(--pressTimeOut) ease;
}
.qr_coreSquare::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  background:radial-gradient(120% 140% at 50% 50%, transparent 60%, rgba(0,0,0,.32) 100%);
  mix-blend-mode:soft-light;
  opacity:.96;
}
.qr_coreSquare::after{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius:inherit;
  pointer-events:none;

  background:
    radial-gradient(140% 120% at 50% 120%,
      rgba(255,255,255,.70) 0%,
      rgba(255,255,255,.30) 26%,
      transparent 56%),
    radial-gradient(170% 120% at 50% -38%,
      rgba(0,0,0,.34) 0%,
      rgba(0,0,0,.14) 16%,
      transparent 34%);

  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;

  padding:6px;
  filter:blur(.78px);
  opacity:.95;
}

.qrWrap{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  pointer-events:none;
  z-index:10;
}
.qrWrap .qrSvg{
  width:88%;
  height:88%;
  display:block;
  shape-rendering:crispEdges;
}

.qr_coreSquare:hover{
  transform:translateY(-1px);
  box-shadow:
    0 22px 30px rgba(0,0,0,.20),
    inset 0 14px 20px rgba(0,0,0,.14),
    inset 0 -14px 20px rgba(255,255,255,.18),
    inset 0 0 0 1px rgba(0,0,0,.16);
}
.glassSquare:has(.qr_coreSquare:active){
  filter:brightness(.985);
  transition:filter var(--pressTimeIn) ease;
}
.glassSquare:has(.qr_coreSquare:active) .qr_pressGlow{
  opacity:1;
  transform:scale(1.01);
  transition:opacity var(--pressTimeIn) ease, transform var(--pressTimeIn) ease;
}
.qr_coreSquare:active{
  transform:translateY(var(--pressY));
  transition:
    transform var(--pressTimeIn) cubic-bezier(.2,.8,.2,1),
    box-shadow var(--pressTimeIn) ease,
    filter var(--pressTimeIn) ease;
  box-shadow:
    0 10px 18px rgba(0,0,0,.16),
    inset 0 20px 26px rgba(0,0,0,.20),
    inset 0 -10px 16px rgba(255,255,255,.12),
    inset 0 0 0 1px rgba(0,0,0,.16);
  filter:brightness(.995) saturate(.98);
}

</style>

<style>
#qrWrap{position:fixed; inset:0; z-index:50; pointer-events:none;}
#qrWrap #wtOrb, #qrWrap #wtOverlay{pointer-events:auto;}
</style>

</head>
<body>

<!-- ===== SHARE MODULE (p≈Øvodn√≠) ===== -->
<div id="shareOrb" class="glassBase circle v-white" aria-label="Share">
  <div class="pressGlow"></div>
  <button class="coreBtn" aria-label="Share">
    <svg class="shareIcon" viewBox="0 0 24 24" aria-hidden="true">
      <circle cx="18" cy="5" r="3"></circle>
      <circle cx="6" cy="12" r="3"></circle>
      <circle cx="18" cy="19" r="3"></circle>
      <path d="M8.7 10.7l6.6-3.4M8.7 13.3l6.6 3.4"></path>
    </svg>
  </button>
</div>

  <div class="main"></div>

  <!-- p≈ôesn√Ω konec str√°nky -->
  <div id="wtBottomSentinel" aria-hidden="true"></div>

  <div id="wtSheetBackdrop"></div>

  <div id="wtActionSheet" role="dialog" aria-modal="true" aria-label="Share">
    <div class="glassPlate" aria-label="glass plate">
      <div class="pressGlow"></div>

      <div class="coreSquare shareCore" role="menu" aria-label="share options">
        <button class="shareRow" type="button" data-action="share">Share</button>
        <button class="shareRow" type="button" data-action="instagram">Instagram</button>
        <button class="shareRow" type="button" data-action="mail">Mail</button>
      </div>
    </div>
  </div>
<script>
  const orb      = document.getElementById("shareOrb");
  const sheet    = document.getElementById("wtActionSheet");
  const back     = document.getElementById("wtSheetBackdrop");
  const sentinel = document.getElementById("wtBottomSentinel");

  let openedManually = false;
  let openedByBottom = false;

  // === scroll heuristika pro auto-hide p≈ôi j√≠zdƒõ nahoru ===
  let lastScrollY = window.scrollY || 0;
  let maxYSinceOpen = lastScrollY;   // nejni≈æ≈°√≠ m√≠sto (nejvƒõt≈°√≠ Y), kam se u≈æivatel po otev≈ôen√≠ dostal
  let hideArmed = false;

  function resetScrollHeuristics(){
    lastScrollY = window.scrollY || 0;
    maxYSinceOpen = lastScrollY;
    hideArmed = false;
  }

  function openSheet({manual=false, byBottom=false}={}){
    openedManually = !!manual;
    openedByBottom = !!byBottom;

    sheet.classList.add("show");
    back.classList.add("show");

    resetScrollHeuristics();
  }

  function closeSheet(){
    sheet.classList.remove("show");
    back.classList.remove("show");

    openedManually = false;
    openedByBottom = false;

    resetScrollHeuristics();
  }

  // ruƒçnƒõ (toggle)
  orb.addEventListener("click", (e)=>{
    e.preventDefault();
    if (sheet.classList.contains("show")) {
      closeSheet();
    } else {
      openSheet({manual:true, byBottom:false});
    }
  });
// zav≈ô√≠t klikem mimo
  back.addEventListener("click", closeSheet);

  // --- AUTO OPEN u konce str√°nky (IntersectionObserver + fallback) ---
  const openByBottomOnce = ()=>{
    if(sheet.classList.contains("show")) return;
    openSheet({manual:false, byBottom:true});
  };

  if("IntersectionObserver" in window){
    const io = new IntersectionObserver((entries)=>{
      const hit = entries.some(e=>e.isIntersecting);
      if(hit){
        openByBottomOnce();
      }else{
        // kdy≈æ jsme to otev≈ôeli kv≈Øli dnu a u≈æ nejsme u dna, zav≈ôi
        if(openedByBottom){
          closeSheet();
        }
      }
    },{
      root: null,
      // citlivost (px p≈ôed koncem). Zv√Ω≈°it = otev≈ôe d≈ô√≠v.
      rootMargin: "0px 0px 220px 0px",
      threshold: 0
    });
    io.observe(sentinel);
  }else{
    // fallback: kdy≈æ jsme fakt bl√≠zko konce, otev≈ôi
    window.addEventListener("scroll", ()=>{
      const scrollPos = window.scrollY + window.innerHeight;
      const docH = document.documentElement.scrollHeight;
      if(docH - scrollPos < 160){
        openByBottomOnce();
      }
    }, {passive:true});
  }

  // --- AUTO HIDE p≈ôi scrollu nahoru (funguje pro ruƒçn√≠ i auto otev≈ôen√≠) ---
  window.addEventListener("scroll", ()=>{
    const y = window.scrollY || 0;
    const dy = y - lastScrollY;
    lastScrollY = y;

    if(!sheet.classList.contains("show")) return;

    // aktualizuj nejni≈æ≈°√≠ dosa≈æen√Ω bod po otev≈ôen√≠
    if(y > maxYSinceOpen){
      maxYSinceOpen = y;
      hideArmed = false; // jde≈° dol≈Ø -> ne
      return;
    }

    // jde≈° nahoru -> po urƒçit√© "trase" schovej
    if(dy < -2){
      const upDistance = (maxYSinceOpen - y);

      // ‚Äûodlep‚Äú od dna: u auto-openu to schovej rychleji
      const THRESH = openedByBottom ? 36 : 56; // px
      const HARD   = openedByBottom ? 90 : 120;

      if(upDistance > THRESH) hideArmed = true;

      if(hideArmed && upDistance > HARD){
        closeSheet();
      }
    }
  }, {passive:true});

</script>

<!-- ===== QR MODULE (p≈Øvodn√≠, jen wrapper + 2 t≈ô√≠dy p≈ôejmenovan√©) ===== -->
<div id="qrWrap">
<div id="wtOrb" aria-label="Sticker" role="button" tabindex="0">
  <img decoding="async" src="assets/wave.gif" alt="sticker">
</div>

<div id="wtOverlay" aria-hidden="true">
  <div class="backdrop" aria-hidden="true"></div>

  <div id="wtCard" role="dialog" aria-label="QR label">
    <div id="wtInner">
      <div class="wtFace wtFront">
        <img class="frontImg" decoding="async" src="assets/wave.gif" alt="sticker">
      </div>

      <div class="wtFace wtBack">
        <div class="glassSquare">
          <div class="qr_pressGlow"></div>
          <button class="qr_coreSquare" aria-label="wave.today QR label">
            <div class="qrWrap" aria-hidden="true">
              <svg class="qrSvg" version="1.1" viewBox="0 0 33 33" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
<path d="M 12 4 L 12 5 L 13 5 L 13 4 z M 23 4 L 23 5 L 24 5 L 24 4 z M 4 9 L 4 10 L 5 10 L 5 9 z M 15 9 L 15 10 L 16 10 L 16 9 z M 12 22 L 12 23 L 13 23 L 13 22 z M 15 18 L 15 19 L 16 19 L 16 18 z M 4 27 L 4 28 L 5 28 L 5 27 z M 15 27 L 15 28 L 16 28 L 16 27 z M 8 6 L 8 7 L 9 7 L 9 6 z M 26 14 L 26 15 L 27 15 L 27 14 z M 7 10 L 7 11 L 8 11 L 8 10 z M 26 23 L 26 24 L 27 24 L 27 23 z M 7 19 L 7 20 L 8 20 L 8 19 z M 7 28 L 7 29 L 8 29 L 8 28 z M 19 11 L 19 12 L 20 12 L 20 11 z M 22 7 L 22 8 L 23 8 L 23 7 z M 11 16 L 11 17 L 12 17 L 12 16 z M 22 16 L 22 17 L 23 17 L 23 16 z M 22 25 L 22 26 L 23 26 L 23 25 z M 12 8 L 12 9 L 13 9 L 13 8 z M 4 4 L 4 5 L 5 5 L 5 4 z M 15 4 L 15 5 L 16 5 L 16 4 z M 14 26 L 14 27 L 15 27 L 15 26 z M 18 5 L 18 6 L 19 6 L 19 5 z M 26 18 L 26 19 L 27 19 L 27 18 z M 26 27 L 26 28 L 27 28 L 27 27 z M 18 23 L 18 24 L 19 24 L 19 23 z M 19 6 L 19 7 L 20 7 L 20 6 z M 11 20 L 11 21 L 12 21 L 12 20 z M 22 20 L 22 21 L 23 21 L 23 20 z M 15 8 L 15 9 L 16 9 L 16 8 z M 6 17 L 6 18 L 7 18 L 7 17 z M 6 26 L 6 27 L 7 27 L 7 26 z M 26 4 L 26 5 L 27 5 L 27 4 z M 18 18 L 18 19 L 19 19 L 19 18 z M 22 6 L 22 7 L 23 7 L 23 6 z M 11 15 L 11 16 L 12 16 L 12 15 z M 10 28 L 10 29 L 11 29 L 11 28 z M 25 26 L 25 27 L 26 27 L 26 26 z M 14 7 L 14 8 L 15 8 L 15 7 z M 14 16 L 14 17 L 15 17 L 15 16 z M 14 25 L 14 26 L 15 26 L 15 25 z M 26 8 L 26 9 L 27 9 L 27 8 z M 7 4 L 7 5 L 8 5 L 8 4 z M 18 13 L 18 14 L 19 14 L 19 13 z M 7 22 L 7 23 L 8 23 L 8 22 z M 21 24 L 21 25 L 22 25 L 22 24 z M 10 14 L 10 15 L 11 15 L 11 14 z M 25 12 L 25 13 L 26 13 L 26 12 z M 10 23 L 10 24 L 11 24 L 11 23 z M 14 11 L 14 12 L 15 12 L 15 11 z M 6 7 L 6 8 L 7 8 L 7 7 z M 6 16 L 6 17 L 7 17 L 7 16 z M 6 25 L 6 26 L 7 26 L 7 25 z M 7 8 L 7 9 L 8 9 L 8 8 z M 18 8 L 18 9 L 19 9 L 19 8 z M 21 19 L 21 20 L 22 20 L 22 19 z M 13 15 L 13 16 L 14 16 L 14 15 z M 21 28 L 21 29 L 22 29 L 22 28 z M 13 24 L 13 25 L 14 25 L 14 24 z M 10 9 L 10 10 L 11 10 L 11 9 z M 25 7 L 25 8 L 26 8 L 26 7 z M 10 18 L 10 19 L 11 19 L 11 18 z M 25 16 L 25 17 L 26 17 L 26 16 z M 10 27 L 10 28 L 11 28 L 11 27 z M 14 6 L 14 7 L 15 7 L 15 6 z M 17 26 L 17 27 L 18 27 L 18 26 z M 20 22 L 20 23 L 21 23 L 21 22 z M 21 14 L 21 15 L 22 15 L 22 14 z M 10 4 L 10 5 L 11 5 L 11 4 z M 10 22 L 10 23 L 11 23 L 11 22 z M 25 20 L 25 21 L 26 21 L 26 20 z M 24 24 L 24 25 L 25 25 L 25 24 z M 14 10 L 14 11 L 15 11 L 15 10 z M 6 6 L 6 7 L 7 7 L 7 6 z M 17 12 L 17 13 L 18 13 L 18 12 z M 28 12 L 28 13 L 29 13 L 29 12 z M 17 21 L 17 22 L 18 22 L 18 21 z M 20 17 L 20 18 L 21 18 L 21 17 z M 5 28 L 5 29 L 6 29 L 6 28 z M 13 5 L 13 6 L 14 6 L 14 5 z M 9 16 L 9 17 L 10 17 L 10 16 z M 10 8 L 10 9 L 11 9 L 11 8 z M 25 6 L 25 7 L 26 7 L 26 6 z M 24 19 L 24 20 L 25 20 L 25 19 z M 28 7 L 28 8 L 29 8 L 29 7 z M 17 16 L 17 17 L 18 17 L 18 16 z M 28 16 L 28 17 L 29 17 L 29 16 z M 28 25 L 28 26 L 29 26 L 29 25 z M 20 21 L 20 22 L 21 22 L 21 21 z M 9 20 L 9 21 L 10 21 L 10 20 z M 13 18 L 13 19 L 14 19 L 14 18 z M 24 14 L 24 15 L 25 15 L 25 14 z M 16 10 L 16 11 L 17 11 L 17 10 z M 27 10 L 27 11 L 28 11 L 28 10 z M 24 23 L 24 24 L 25 24 L 25 23 z M 27 19 L 27 20 L 28 20 L 28 19 z M 16 28 L 16 29 L 17 29 L 17 28 z M 27 28 L 27 29 L 28 29 L 28 28 z M 8 24 L 8 25 L 9 25 L 9 24 z M 17 11 L 17 12 L 18 12 L 18 11 z M 20 7 L 20 8 L 21 8 L 21 7 z M 17 20 L 17 21 L 18 21 L 18 20 z M 20 25 L 20 26 L 21 26 L 21 25 z M 13 13 L 13 14 L 14 14 L 14 13 z M 12 17 L 12 18 L 13 18 L 13 17 z M 4 22 L 4 23 L 5 23 L 5 22 z M 24 18 L 24 19 L 25 19 L 25 18 z M 24 27 L 24 28 L 25 28 L 25 27 z M 8 10 L 8 11 L 9 11 L 9 10 z M 16 23 L 16 24 L 17 24 L 17 23 z M 27 23 L 27 24 L 28 24 L 28 23 z M 8 28 L 8 29 L 9 29 L 9 28 z M 5 4 L 5 5 L 6 5 L 6 4 z M 28 6 L 28 7 L 29 7 L 29 6 z M 5 13 L 5 14 L 6 14 L 6 13 z M 5 22 L 5 23 L 6 23 L 6 22 z M 20 20 L 20 21 L 21 21 L 21 20 z M 9 10 L 9 11 L 10 11 L 10 10 z M 12 12 L 12 13 L 13 13 L 13 12 z M 23 12 L 23 13 L 24 13 L 24 12 z M 4 8 L 4 9 L 5 9 L 5 8 z M 12 21 L 12 22 L 13 22 L 13 21 z M 4 17 L 4 18 L 5 18 L 5 17 z M 4 26 L 4 27 L 5 27 L 5 26 z M 15 26 L 15 27 L 16 27 L 16 26 z M 24 4 L 24 5 L 25 5 L 25 4 z M 24 13 L 24 14 L 25 14 L 25 13 z M 24 22 L 24 23 L 25 23 L 25 22 z M 16 18 L 16 19 L 17 19 L 17 18 z M 8 14 L 8 15 L 9 15 L 9 14 z M 27 27 L 27 28 L 28 28 L 28 27 z M 28 10 L 28 11 L 29 11 L 29 10 z M 20 6 L 20 7 L 21 7 L 21 6 z M 19 19 L 19 20 L 20 20 L 20 19 z M 22 24 L 22 25 L 23 25 L 23 24 z M 12 7 L 12 8 L 13 8 L 13 7 z M 4 12 L 4 13 L 5 13 L 5 12 z M 23 25 L 23 26 L 24 26 L 24 25 z M 24 8 L 24 9 L 25 9 L 25 8 z M 27 4 L 27 5 L 28 5 L 28 4 z M 24 17 L 24 18 L 25 18 L 25 17 z M 27 13 L 27 14 L 28 14 L 28 13 z M 8 18 L 8 19 L 9 19 L 9 18 z M 19 14 L 19 15 L 20 15 L 20 14 z M 22 10 L 22 11 L 23 11 L 23 10 z M 22 19 L 22 20 L 23 20 L 23 19 z M 22 28 L 22 29 L 23 29 L 23 28 z M 12 11 L 12 12 L 13 12 L 13 11 z M 4 7 L 4 8 L 5 8 L 5 7 z M 23 20 L 23 21 L 24 21 L 24 20 z M 4 16 L 4 17 L 5 17 L 5 16 z M 4 25 L 4 26 L 5 26 L 5 25 z M 16 8 L 16 9 L 17 9 L 17 8 z M 8 4 L 8 5 L 9 5 L 9 4 z M 8 13 L 8 14 L 9 14 L 9 13 z M 7 17 L 7 18 L 8 18 L 8 17 z M 7 26 L 7 27 L 8 27 L 8 26 z M 18 26 L 18 27 L 19 27 L 19 26 z M 22 5 L 22 6 L 23 6 L 23 5 z M 19 18 L 19 19 L 20 19 L 20 18 z M 19 27 L 19 28 L 20 28 L 20 27 z M 12 15 L 12 16 L 13 16 L 13 15 z M 23 15 L 23 16 L 24 16 L 24 15 z M 15 11 L 15 12 L 16 12 L 16 11 z M 4 20 L 4 21 L 5 21 L 5 20 z M 14 24 L 14 25 L 15 25 L 15 24 z M 26 7 L 26 8 L 27 8 L 27 7 z M 26 16 L 26 17 L 27 17 L 27 16 z M 26 25 L 26 26 L 27 26 L 27 25 z M 18 21 L 18 22 L 19 22 L 19 21 z M 19 4 L 19 5 L 20 5 L 20 4 z M 19 13 L 19 14 L 20 14 L 20 13 z M 22 9 L 22 10 L 23 10 L 23 9 z M 11 18 L 11 19 L 12 19 L 12 18 z M 23 10 L 23 11 L 24 11 L 24 10 z M 4 6 L 4 7 L 5 7 L 5 6 z M 14 28 L 14 29 L 15 29 L 15 28 z M 6 24 L 6 25 L 7 25 L 7 24 z M 7 7 L 7 8 L 8 8 L 8 7 z M 26 20 L 26 21 L 27 21 L 27 20 z M 7 16 L 7 17 L 8 17 L 8 16 z M 18 16 L 18 17 L 19 17 L 19 16 z M 7 25 L 7 26 L 8 26 L 8 25 z M 19 8 L 19 9 L 20 9 L 20 8 z M 22 4 L 22 5 L 23 5 L 23 4 z M 19 17 L 19 18 L 20 18 L 20 17 z M 22 22 L 22 23 L 23 23 L 23 22 z M 10 26 L 10 27 L 11 27 L 11 26 z M 25 24 L 25 25 L 26 25 L 26 24 z M 14 5 L 14 6 L 15 6 L 15 5 z M 6 10 L 6 11 L 7 11 L 7 10 z M 14 23 L 14 24 L 15 24 L 15 23 z M 11 12 L 11 13 L 12 13 L 12 12 z M 6 19 L 6 20 L 7 20 L 7 19 z M 6 28 L 6 29 L 7 29 L 7 28 z M 26 6 L 26 7 L 27 7 L 27 6 z M 26 15 L 26 16 L 27 16 L 27 15 z M 26 24 L 26 25 L 27 25 L 27 24 z M 22 8 L 22 9 L 23 9 L 23 8 z M 10 12 L 10 13 L 11 13 L 11 12 z M 25 10 L 25 11 L 26 11 L 26 10 z M 14 18 L 14 19 L 15 19 L 15 18 z M 14 27 L 14 28 L 15 28 L 15 27 z M 26 10 L 26 11 L 27 11 L 27 10 z M 7 6 L 7 7 L 8 7 L 8 6 z M 18 6 L 18 7 L 19 7 L 19 6 z M 7 15 L 7 16 L 8 16 L 8 15 z M 18 15 L 18 16 L 19 16 L 19 15 z M 21 17 L 21 18 L 22 18 L 22 17 z M 21 26 L 21 27 L 22 27 L 22 26 z M 10 7 L 10 8 L 11 8 L 11 7 z M 10 16 L 10 17 L 11 17 L 11 16 z M 25 14 L 25 15 L 26 15 L 26 14 z M 10 25 L 10 26 L 11 26 L 11 25 z M 25 23 L 25 24 L 26 24 L 26 23 z M 14 22 L 14 23 L 15 23 L 15 22 z M 6 18 L 6 19 L 7 19 L 7 18 z M 17 24 L 17 25 L 18 25 L 18 24 z M 28 24 L 28 25 L 29 25 L 29 24 z M 18 10 L 18 11 L 19 11 L 19 10 z M 21 12 L 21 13 L 22 13 L 22 12 z M 13 8 L 13 9 L 14 9 L 14 8 z M 13 17 L 13 18 L 14 18 L 14 17 z M 9 28 L 9 29 L 10 29 L 10 28 z M 13 26 L 13 27 L 14 27 L 14 26 z M 10 20 L 10 21 L 11 21 L 11 20 z M 25 18 L 25 19 L 26 19 L 26 18 z M 25 27 L 25 28 L 26 28 L 26 27 z M 6 4 L 6 5 L 7 5 L 7 4 z M 6 13 L 6 14 L 7 14 L 7 13 z M 6 22 L 6 23 L 7 23 L 7 22 z M 17 19 L 17 20 L 18 20 L 18 19 z M 17 28 L 17 29 L 18 29 L 18 28 z M 28 28 L 28 29 L 29 29 L 29 28 z M 20 24 L 20 25 L 21 25 L 21 24 z M 9 14 L 9 15 L 10 15 L 10 14 z M 21 16 L 21 17 L 22 17 L 22 16 z M 21 25 L 21 26 L 22 26 L 22 25 z M 13 21 L 13 22 L 14 22 L 14 21 z M 10 6 L 10 7 L 11 7 L 11 6 z M 25 4 L 25 5 L 26 5 L 26 4 z M 25 13 L 25 14 L 26 14 L 26 13 z M 10 24 L 10 25 L 11 25 L 11 24 z M 6 8 L 6 9 L 7 9 L 7 8 z M 17 5 L 17 6 L 18 6 L 18 5 z M 28 5 L 28 6 L 29 6 L 29 5 z M 20 10 L 20 11 L 21 11 L 21 10 z M 28 23 L 28 24 L 29 24 L 29 23 z M 9 18 L 9 19 L 10 19 L 10 18 z M 21 20 L 21 21 L 22 21 L 22 20 z M 10 10 L 10 11 L 11 11 L 11 10 z M 25 8 L 25 9 L 26 9 L 26 8 z M 24 12 L 24 13 L 25 13 L 25 12 z M 24 21 L 24 22 L 25 22 L 25 21 z M 16 17 L 16 18 L 17 18 L 17 17 z M 27 17 L 27 18 L 28 18 L 28 17 z M 16 26 L 16 27 L 17 27 L 17 26 z M 27 26 L 27 27 L 28 27 L 28 26 z M 8 22 L 8 23 L 9 23 L 9 22 z M 28 9 L 28 10 L 29 10 L 29 9 z M 20 5 L 20 6 L 21 6 L 21 5 z M 17 18 L 17 19 L 18 19 L 18 18 z M 17 27 L 17 28 L 18 28 L 18 27 z M 20 23 L 20 24 L 21 24 L 21 23 z M 9 4 L 9 5 L 10 5 L 10 4 z M 9 13 L 9 14 L 10 14 L 10 13 z M 9 22 L 9 23 L 10 23 L 10 22 z M 10 5 L 10 6 L 11 6 L 11 5 z M 12 24 L 12 25 L 13 25 L 13 24 z M 23 24 L 23 25 L 24 25 L 24 24 z M 24 7 L 24 8 L 25 8 L 25 7 z M 8 8 L 8 9 L 9 9 L 9 8 z M 8 17 L 8 18 L 9 18 L 9 17 z M 8 26 L 8 27 L 9 27 L 9 26 z M 28 4 L 28 5 L 29 5 L 29 4 z M 17 13 L 17 14 L 18 14 L 18 13 z M 5 20 L 5 21 L 6 21 L 6 20 z M 20 18 L 20 19 L 21 19 L 21 18 z M 12 10 L 12 11 L 13 11 L 13 10 z M 23 19 L 23 20 L 24 20 L 24 19 z M 15 15 L 15 16 L 16 16 L 16 15 z M 12 28 L 12 29 L 13 29 L 13 28 z M 4 24 L 4 25 L 5 25 L 5 24 z M 15 24 L 15 25 L 16 25 L 16 24 z M 16 7 L 16 8 L 17 8 L 17 7 z M 24 20 L 24 21 L 25 21 L 25 20 z M 27 16 L 27 17 L 28 17 L 28 16 z M 8 12 L 8 13 L 9 13 L 9 12 z M 16 25 L 16 26 L 17 26 L 17 25 z M 27 25 L 27 26 L 28 26 L 28 25 z M 28 8 L 28 9 L 29 9 L 29 8 z M 20 4 L 20 5 L 21 5 L 21 4 z M 20 13 L 20 14 L 21 14 L 21 13 z M 23 14 L 23 15 L 24 15 L 24 14 z M 4 10 L 4 11 L 5 11 L 5 10 z M 15 19 L 15 20 L 16 20 L 16 19 z M 4 28 L 4 29 L 5 29 L 5 28 z M 24 6 L 24 7 L 25 7 L 25 6 z M 8 7 L 8 8 L 9 8 L 9 7 z M 16 20 L 16 21 L 17 21 L 17 20 z M 8 25 L 8 26 L 9 26 L 9 25 z M 5 10 L 5 11 L 6 11 L 6 10 z M 20 8 L 20 9 L 21 9 L 21 8 z M 19 21 L 19 22 L 20 22 L 20 21 z M 22 26 L 22 27 L 23 27 L 23 26 z M 12 9 L 12 10 L 13 10 L 13 9 z M 4 5 L 4 6 L 5 6 L 5 5 z M 12 18 L 12 19 L 13 19 L 13 18 z M 23 18 L 23 19 L 24 19 L 24 18 z M 4 14 L 4 15 L 5 15 L 5 14 z M 15 14 L 15 15 L 16 15 L 16 14 z M 23 27 L 23 28 L 24 28 L 24 27 z M 4 23 L 4 24 L 5 24 L 5 23 z M 24 10 L 24 11 L 25 11 L 25 10 z M 16 6 L 16 7 L 17 7 L 17 6 z M 27 15 L 27 16 L 28 16 L 28 15 z M 26 19 L 26 20 L 27 20 L 27 19 z M 26 28 L 26 29 L 27 29 L 27 28 z M 7 24 L 7 25 L 8 25 L 8 24 z M 18 24 L 18 25 L 19 25 L 19 24 z M 19 7 L 19 8 L 20 8 L 20 7 z M 19 16 L 19 17 L 20 17 L 20 16 z M 22 12 L 22 13 L 23 13 L 23 12 z" id="qr-path" fill="#000000" fill-opacity="1" fill-rule="nonzero" stroke="none"/>
</svg>
            </div>
          </button>
        </div>
      </div>

    </div>
  </div>
</div>
</div>
<script>
(() => {
  const orb = document.getElementById('wtOrb');
  const overlay = document.getElementById('wtOverlay');
  const card = document.getElementById('wtCard');
  const inner = document.getElementById('wtInner');
  if(!orb || !overlay || !card || !inner) return;

  // ===== Orb: rubber drag + walls + bounce + spring home (+ shake impulse while returning) =====
  ['contextmenu','dragstart','selectstart'].forEach(ev=>{
    orb.addEventListener(ev, e=>e.preventDefault(), {capture:true});
  });

  let pointerId = null, isDragging = false;
  let downX = 0, downY = 0, startX = 0, startY = 0;
  let curX = 0, curY = 0, dragBaseX = 0, dragBaseY = 0;
  let suppressTap = false, pressTimer = null;

  let anchorRect = null;
  const bounds = {minX:0,maxX:0,minY:0,maxY:0};

  const recomputeBounds = () => {
    const prev = orb.style.transform;
    orb.style.transform = 'translate3d(0,0,0)';
    anchorRect = orb.getBoundingClientRect();
    orb.style.transform = prev;

    const margin = 10;
    const vw = window.innerWidth;
    const vh = window.innerHeight;

    bounds.minX = -(anchorRect.left - margin);
    bounds.maxX = (vw - margin) - anchorRect.right;
    bounds.minY = -(anchorRect.top - margin);
    bounds.maxY = (vh - margin) - anchorRect.bottom;
  };

  const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
  const wallBounce = (v, min, max) => v < min ? (min + (min - v) * 0.35) : (v > max ? (max - (v - max) * 0.35) : v);

  const apply = (x,y) => {
    curX = wallBounce(x, bounds.minX, bounds.maxX);
    curY = wallBounce(y, bounds.minY, bounds.maxY);
    orb.style.transform = `translate3d(${curX}px, ${curY}px, 0)`;
  };

  const LIMIT = 180;
  const rubber = (d) => {
    const ad = Math.abs(d);
    if(ad <= LIMIT) return d;
    return Math.sign(d) * (LIMIT + (ad - LIMIT) * 0.28);
  };

  let returning = false, rafId = 0, vx = 0, vy = 0, lastShakeT = 0;

  const stopReturn = ()=>{
    returning = false;
    if(rafId) cancelAnimationFrame(rafId);
    rafId = 0;
  };

  function springHome(){
    stopReturn();
    returning = true;

    const k = 0.010, c = 0.22, R = 0.45; // tuned slower + less bouncy
    vx = 0; vy = 0;
    let last = performance.now();

    function step(t){
      if(!returning) return;

      const dt = Math.min(0.032, (t - last)/1000);
      last = t;

      const ax = -k*curX - c*vx;
      const ay = -k*curY - c*vy;

      vx += ax * dt;
      vy += ay * dt;

      curX += vx * (dt*40);
      curY += vy * (dt*40);

      if(curX < bounds.minX){ curX = bounds.minX; vx = -vx * R; }
      else if(curX > bounds.maxX){ curX = bounds.maxX; vx = -vx * R; }
      if(curY < bounds.minY){ curY = bounds.minY; vy = -vy * R; }
      else if(curY > bounds.maxY){ curY = bounds.maxY; vy = -vy * R; }

      orb.style.transform = `translate3d(${curX}px, ${curY}px, 0)`;

      if(Math.abs(curX) < 0.35 && Math.abs(curY) < 0.35 && Math.abs(vx) < 0.2 && Math.abs(vy) < 0.2){
        curX = 0; curY = 0;
        orb.style.transform = 'translate3d(0,0,0)';
        orb.classList.remove('wt-dragging');
        orb.style.willChange = '';
        isDragging = false;
        suppressTap = false;
        stopReturn();
        return;
      }
      rafId = requestAnimationFrame(step);
    }
    rafId = requestAnimationFrame(step);
  }

  // iOS motion permission (silent)
  let motionEnabled = false;
  const enableMotion = async ()=>{
    if(motionEnabled) return;
    motionEnabled = true;
    try{
      if(typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function'){
        const res = await DeviceMotionEvent.requestPermission();
        if(res !== 'granted') return;
      }
    }catch(_){ return; }
    window.addEventListener('devicemotion', onMotion, {passive:true});
  };

  const onMotion = (ev)=>{
    if(!returning || orb.style.display === 'none') return;
    const acc = ev.accelerationIncludingGravity || ev.acceleration;
    if(!acc) return;

    const ax = acc.x || 0, ay = acc.y || 0, az = acc.z || 0;
    const mag = Math.sqrt(ax*ax + ay*ay + az*az);

    if(mag < 3.0) return;
    const now = performance.now();
    if(now - lastShakeT < 90) return;
    lastShakeT = now;

    const GAIN = 0.55;
    vx += ax * GAIN;
    vy += -ay * GAIN;
  };

  window.__WT_ORB_API = {
    recomputeBounds,
    setPos: (x,y) => {
      recomputeBounds();
      curX = clamp(x, bounds.minX, bounds.maxX);
      curY = clamp(y, bounds.minY, bounds.maxY);
      orb.style.transform = `translate3d(${curX}px, ${curY}px, 0)`;
    },
    moveToViewportCenter: () => {
      recomputeBounds();
      const cx = window.innerWidth * 0.5;
      const cy = window.innerHeight * 0.5;
      const ax = anchorRect.left + anchorRect.width * 0.5;
      const ay = anchorRect.top  + anchorRect.height * 0.5;
      window.__WT_ORB_API.setPos(cx - ax, cy - ay);
    },
    springHome: () => {
      if(isDragging) return;
      recomputeBounds();
      orb.classList.add('wt-dragging');
      orb.style.willChange = 'transform';
      suppressTap = true;
      springHome();
    }
  };

  recomputeBounds();
  window.addEventListener('resize', () => {
    recomputeBounds();
    apply(curX, curY);
  }, {passive:true});

  orb.addEventListener('click', (e) => {
    if(suppressTap){ e.preventDefault(); e.stopPropagation(); }
  }, true);

  // One gesture is enough
  document.addEventListener('pointerdown', () => { enableMotion(); }, {passive:true, capture:true, once:true});

  orb.addEventListener('pointerdown', (e) => {
    if(e.button !== undefined && e.button !== 0) return;
    pointerId = e.pointerId;
    downX = e.clientX; downY = e.clientY;
    startX = e.clientX; startY = e.clientY;
    suppressTap = false;

    dragBaseX = curX;
    dragBaseY = curY;

    stopReturn();

    clearTimeout(pressTimer);
    pressTimer = setTimeout(() => {
      isDragging = true;
      suppressTap = true;
      orb.classList.add('wt-dragging');
      orb.style.willChange = 'transform';
      try{ orb.setPointerCapture(pointerId); }catch(_){}
    }, 170);
  });

  orb.addEventListener('pointermove', (e) => {
    if(pointerId === null || e.pointerId !== pointerId) return;

    const dx = e.clientX - startX;
    const dy = e.clientY - startY;

    if(!isDragging){
      if(Math.hypot(e.clientX - downX, e.clientY - downY) > 10){
        clearTimeout(pressTimer);
        pressTimer = null;
        isDragging = true;
        suppressTap = true;
        orb.classList.add('wt-dragging');
        orb.style.willChange = 'transform';
        try{ orb.setPointerCapture(pointerId); }catch(_){}
      }else{
        return;
      }
    }
    apply(dragBaseX + rubber(dx), dragBaseY + rubber(dy));
  });

  const end = () => {
    clearTimeout(pressTimer);
    pressTimer = null;
    pointerId = null;
    if(isDragging) springHome();
  };
  orb.addEventListener('pointerup', end);
  orb.addEventListener('pointercancel', end);

  // ===== Overlay: never show orb and card at the same time =====
  overlay.classList.remove('is-open');
  overlay.style.display = 'none';
  orb.style.display = 'block';

  let state = 'closed'; // closed | opening | open | closing

  const waitTransformEnd = (timeoutMs=820)=> new Promise((resolve)=>{
    let done = false;
    const finish = ()=>{
      if(done) return;
      done = true;
      inner.removeEventListener('transitionend', onEnd);
      resolve();
    };
    const onEnd = (ev)=>{ if(ev.propertyName === 'transform') finish(); };
    inner.addEventListener('transitionend', onEnd);
    setTimeout(finish, timeoutMs);
  });

  const open = ()=>{
    if(state !== 'closed') return;
    state = 'opening';
    orb.style.display = 'none';
    overlay.style.display = 'grid';
    requestAnimationFrame(()=> overlay.classList.add('is-open'));
    waitTransformEnd().then(()=>{ if(state === 'opening') state = 'open'; });
  };

  const close = ()=>{
    if(state !== 'open') return;
    state = 'closing';
    overlay.classList.remove('is-open');

    waitTransformEnd().then(()=>{
      overlay.style.display = 'none';

      orb.style.display = 'block';
      orb.style.visibility = 'hidden';

      window.__WT_ORB_API?.recomputeBounds?.();
      window.__WT_ORB_API?.moveToViewportCenter?.();

      orb.style.visibility = '';
      window.__WT_ORB_API?.springHome?.();

      state = 'closed';
    });
  };

  orb.addEventListener('click', (e)=>{
    if(e.defaultPrevented) return;
    e.preventDefault();
    open();
  });

  card.addEventListener('click', (e)=>{
    e.preventDefault();
    e.stopPropagation();
    close();
  });

  document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') close(); });

  // Extra: prevent drag-ghost & context menu inside orb/card
  [document.documentElement, document.body, orb, overlay, card].forEach((el)=>{
    el?.addEventListener('contextmenu', (e)=>e.preventDefault(), {capture:true});
  });
  [orb, card].forEach((root)=>{
    root?.querySelectorAll('img, svg').forEach((n)=>{
      n.setAttribute('draggable','false');
      n.addEventListener('dragstart', (e)=>e.preventDefault(), {capture:true});
      n.addEventListener('contextmenu', (e)=>e.preventDefault(), {capture:true});
    });
  });
})();
</script>

</body>
</html>
